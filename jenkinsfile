pipeline{
  agent any
  triggers {
  cron('0 06 * * *')
  }
  stages{
    stage("code checkout"){
      steps{
      bat "echo hello"
      }
    }
    stage("code build"){
        steps{
          bat "mvn clean"
        }
      }  
       stage("code test"){
          steps{
          bat "mvn test"
        }
      }
        stage('SonarQube analysis') {
          def scannerHome = tool 'sonar_local';
          withSonarQubeEnv('sonar_local') {
          sh "${scannerHome}/bin/sonar-scanner \
          -D sonar.login=admin \
          -D sonar.password=Test@1234 \
          -D sonar.projectKey=sonarqubetest \
          -D sonar.host.url=http://localhost:9000/"
    }
}
      stage("Publish to Artifactory"){
        steps{
              rtMavenDeployer(
                  id: 'deployer',
                  serverId:'nagp@govinda',
                  releaseRepo:'govinda1988',
                  snapshotRepo:'govinda1988',
                )
              rtMavenRun(
                  pom: 'pom.xml',
                  goals:'clean install',
                  deployerId:'deployer'
              )
              rtPublishBuildInfo(
                  serverId:'nagp@govinda',
              )
            }
              
      }
      
      
}

}
  post {
    success{
        bat "echo success"
            }
      }

  
